# Introdu√ß√£o √† An√°lises Multidimensionais

Em geral, an√°lises multivariadas t√™m tr√™s principais utilidades: reduzir a dimensionalidade dos dados e encontrar a principal dire√ß√£o de varia√ß√£o dos dados, testar rela√ß√µes entre matrizes, ou ainda encontrar diferen√ßas entre grupos. Apesar dessas an√°lises tamb√©m serem utilizadas como an√°lises explorat√≥rias e para descrever padr√µes em estudos ecol√≥gicos, a necessidade de se ter hip√≥teses, ou ao menos expectativas a priori, n√£o pode ser ignorada. Antes de entrar de cabe√ßa nas an√°lises multivariadas tamb√©m, sugerimos fortemente o estudo de m√©todos de amostragem e como fazer boas perguntas.

An√°lises multivariadas podem ser divididas, grosseiramente, em dois tipos: agrupamento e ordena√ß√£o. An√°lises de agrupamento em geral tentam agrupar objetos (observa√ß√µes) ou descritores em grupos de maneira que objetos do mesmo grupo sejam mais semelhantes entre si do que objetos de outros grupos (Legendre & Legendre, 2012). Por outro lado, a an√°lise de ordena√ß√£o √© uma opera√ß√£o pela qual os objetos (ou descritores) s√£o posicionados num espa√ßo que cont√©m menos dimens√µes que o conjunto de dados original; a posi√ß√£o dos objetos ou descritores em rela√ß√£o aos outros tamb√©m podem ser usadas para agrup√°-los.

Vamos come√ßar com an√°lises de agrupamento. Aqui vamos exemplificar dois m√©todos: uma t√©cnica de agrupamento hierarquica (dendrograma) e outra n√£o-hierarquica (k-means).

## Coeficientes de associa√ß√£o

Assim chamados genericamente, os coeficientes de associa√ß√£o medem o qu√£o parecidos objetos ou descritores s√£o entre si. Quando analisamos a rela√ß√£o entre objetos fazemos uma an√°lise no modo Q, ao passo que o modo R √© quando analisamos a rela√ß√£o entre descritores. Coeficientes de associa√ß√£o do modo Q s√£o medidas de (dis)similaridade ou dist√¢ncia, enquanto para o modo R utilizamos covari√¢ncia ou correla√ß√£o. Como j√° tratamos neste livro sobre covari√¢ncia e correla√ß√£o, neste t√≥pico vamos falar sobre √≠ndices de dist√¢ncia e similaridade. Mas qual a defini√ß√£o destas duas quantitades?

> Similaridade s√£o m√°ximas (*S=1*) quando dois objetos s√£o id√™nticos
>
> Dist√¢ncias s√£o o contr√°rio da similaridade (*D=1-S*) e n√£o t√™m limites superiores (dependem da unidade de medida)

Existem ao menos 26 √≠ndices de similaridade que podem ser agrupados de acordo com o tipo de dado (qualitativos ou quantitativos), a maneira com que lidam com duplos zeros (sim√©tricos ou assim√©tricos). Do seu lado, as dist√¢ncias s√≥ se aplicam a dados quantitativos e t√™m como caracter√≠sticas serem m√©tricas, semi-m√©tricas ou n√£o-m√©tricas. Vejamos agora os principais √≠ndices de similaridade e dist√¢ncia de cada tipo.

### Dist√¢ncias m√©tricas

O principal coeficiente de dist√¢ncia usado em ecologia √© a dist√¢ncia euclidiana. Al√©m disso temos ainda Canberra, Mahalanobis (calcula a dist√¢ncia entre dois pontos num espa√ßo n√£o ortogonal, levando em considera√ß√£o a covari√¢ncia entre descritores), Manhattan, Chord (elimina diferen√ßas entre abund√¢ncia total de esp√©cies), ùúí2 (d√° peso maior para esp√©cies raras), Hellinger (n√£o d√° peso para esp√©cies raras). Essas dist√¢ncias s√£o recomendada nos casos em que as vari√°veis de estudo forem cont√≠nuas, como por exemplo **vari√°veis morfom√©tricas ou descritores ambientais**.

Uma caracter√≠stica comum de conjuntos de dados ecol√≥gicos s√£o os v√°rios zeros encontrados em matrizes de composi√ß√£o. Eles surgem porque n√£o encontramos nenhum indiv√≠duo de uma determinada esp√©cie num local, seja porque aquele local n√£o tem as condi√ß√µes ambientais adequadas a ela, falha na detectabilidade, ou din√¢micas demogr√°ficas estoc√°sticas de coloniza√ß√£o-extin√ß√£o. Logo, quando dois locais compartilham aus√™ncia de esp√©cies, n√£o √© poss√≠vel atribuir uma √∫nica raz√£o da dupla aus√™ncia. Como essas medidas de dist√¢ncia apresentadas acima assumem que os dados s√£o quantitativos e n√£o de contagem, elas n√£o s√£o adequadas para lidar com dados de abund√¢ncia ou incid√™ncia de esp√©cies, porque atribuem um grau de parec√™n√ßa a pares de locais que compartilham zeros [@numerica2012]. Por esse motivo precisamos de coeficientes que desconsiderem os duplos zeros. Eles s√£o chamados de *assim√©tricos.*

### Coeficientes assim√©tricos bin√°rios para objetos

Esses coeficientes (ou √≠ndices) s√£o apropriados para dados de incid√™ncia de esp√©cies (presen√ßa-aus√™ncia) e desconsideram as duplas aus√™ncias. Os √≠ndices deste tipo mais comuns utilizados em ecologia s√£o S√∏rensen, Jaccard, e Ochiai.

$$
\beta j= a/a+b+c
$$

, onde *a* = n√∫mero de esp√©cies compartilhadas, *b* = n√∫mero de esp√©cies exclusivas da comunidade 1, *c* = n√∫mero de esp√©cies exclusivas da comunidade 2. A diferen√ßa entre Jaccard e S√∏rensen √© o S√∏rensen d√° peso dobrado para duplas presen√ßas. Por conta dessas caracter√≠sticas estes √≠ndices s√£o adequados para quantificar diversidade beta [@legendre2013] [@anderson2010]. Esses √≠ndices variam entre 0 (nenhuma esp√©cie √© compartilhada entre o par de locais) a 1 (todas as esp√©cies s√£o compartilhadas entre o par de locais).

### Coeficientes bin√°rios para descritores (R mode)

Se o objetivo for calcular a similaridade entre descritores bin√°rios (e.g., presen√ßa ou aus√™ncia de caracter√≠sticas ambientais) de pares de locais, geralmente o coeficiente recomendado √© o de Sokal & Michener. Este √≠ndice est√° implementado em `ade4::dist.binary`.

### Coeficientes quantitativos para objetos 

Estes s√£o os coeficientes utilizados para dados de contagem (e.g., abund√¢ncia), quantitativos (e.g., frequ√™ncia, biomassa, porcentagem cobertura). Diferentemente das dist√¢ncias, estes coeficientes s√£o assim√©tricos, ou seja, n√£o consideram duplas aus√™ncias, e portanto s√£o adequados para analisar dados de composi√ß√£o de esp√©cies. Al√©m disso, uma outra caracter√≠stica deles √© serem semi-m√©tricos. Os √≠ndices mais comuns deste tipo s√£o Bray-Curtis (percentage difference), Chord, log-Chord, Hellinger, chi-quadrado, e Morisita-Horn.

Todos os √≠ndices discutidos at√© aqui est√£o implementados nas fun√ß√µes `ade4::dist.ktab`, `adespatial::dist.ldc`, e `vegan::vegdist`.

### Coeficientes para descritores (R mode) que que inclui mistura de tipos de dados

√â comum em an√°lises de diversidade funcional que tenhamos um conjunto de atributos (traits) de esp√©cies que s√£o formados por v√°rios tipos de dados: quantitativos (e.g., tamanho de corpo), bin√°rios (presen√ßa aus√™ncia de uma dada caracter√≠stica), fuzzy (um atributo multiestado descrito codificado em v√°rias colunas com porcentagem), ordinais, e circulares (e.g., distribui√ß√£o de uma fenofase ao longo de um ano). O √≠ndice que lida com todos esses dados √© o Gower. A vers√£o extendida do √≠ndice de Gower pode ser encontrada na fun√ß√£o `ade4::dist.ktab.`

O cap√≠tulo 7 de [@numerica2012] fornece uma chave dicot√¥mica para escolha do √≠ndice mais adequado.

## Padroniza√ß√µes e transforma√ß√µes

√â comum coletarmos m√∫ltiplas vari√°veis ambientais cujas unidades sejam diferentes. Por exemplo, temperatura (¬∫C), dist√¢ncia da margem (m), √°rea (m^2^). Para diminuir a taxa de Erro Tipo I das an√°lises √© recomendado que ***padronizemos*** os dados utilizando distribui√ß√£o *Z*, assim todas as vari√°veis passam a ter m√©dia 0 e desvio padr√£o 1. Essa padroniza√ß√£o pode ser implementada na fun√ß√£o `vegan::decostand`.

Um outro problema comum de matrizes de dados de composi√ß√£o de esp√©cies √© o alto n√∫mero de zeros, enquanto outras esp√©cies podem ter altas abund√¢ncias. Isso gera problemas em ordena√ß√µes. Para diminuir esta discrep√¢ncia podemos ***transformar*** os dados, por exemplo, utilizando a dist√¢ncia de Hellinger ou Chord. Isso pode ser feito na fun√ß√£o `vegan::decostand`.

# An√°lise de agrupamento hierarquico

## Backgorund da an√°lise

O objetivo da an√°lise de agrupamento √© agrupar objetos admitindo que haja um grau de similaridade entre eles. Esta an√°lise pode ser utilizada ainda para classificar uma popula√ß√£o em grupos homog√™neos de acordo com uma caracter√≠stica de interesse. A grosso modo, uma an√°lise de agrupamento tenta resumir uma grande quantidade de dados e apresent√°la de maneira f√°cil de visualizar e entender (em geral, na forma de um dendrograma). No entanto, os resultados da an√°lise podem n√£o refletir necessariamente toda a informa√ß√£o originalmente contida na matriz de dados. Para avaliar o qu√£o bem uma an√°lise de agrupamento representa os dados originais existe uma m√©trica --- o coeficiente de correla√ß√£o cofen√©tico --- o qual discutiremos em detalhes mais adiante.

Antes de considerar algum m√©todo de agrupamento, pense porque voc√™ esperaria que houvesse uma descontinuidade nos dados; ou ainda, considere se existe algum ganho pr√°tico em dividir uma nuvem de objetos cont√≠nuos em grupos. O padr√£o apresentado pelo dendograma depende do protocolo utilizado (m√©todo de agrupamento e √≠ndice de dissimilaridade); os grupos formados dependem do n√≠vel de corte escolhido.

### Explica√ß√£o da an√°lise

A matriz deve conter os objetos a serem agrupados (e.g., esp√©cies) nas linhas e as vari√°veis (e.g., locais de coleta ou medidas morfol√≥gicas) nas colunas. A escolha do m√©todo de agrupamento √© cr√≠tico para a escolha de um coeficiente de associa√ß√£o. √â importante compreender as propriedades dos m√©todos de agrupamento para interpretar corretamente a estrutura ecol√≥gica que eles evidenciam [@numerica2012]. De acordo com a classifica√ß√£o de Sneath & Sokal (1973) existem cinco tipos de m√©todos: 1) sequÃàenciais ou simult√¢neos; 2) aglomerativo ou divisivo ;3) monot√©ticos ou polit√©ticos; 4) hier√°rquico ou n√£o hier√°rquicos e 5) probabil√≠stico.

M√©todos hier√°rquicos podem ser divididos naqueles que consideram o centr√≥ide ou a m√©dia aritm√©tica entre os grupos. O principal m√©todo hier√°rquico que utiliza a m√©dia aritm√©tica √© o UPGMA (Agrupamento pelas m√©dias aritm√©ticas n√£o ponderadas), e o principal m√©todo que utiliza centr√≥ides √© a Dist√¢ncia m√≠nima de Ward.

O UPGMA funciona da seguinte forma: a maior similaridade (ou menor dist√¢ncia) identifica os pr√≥ximos agrupamentos a serem formados. Ap√≥s esse evento, o m√©todo calcula a m√©dia aritm√©tica das similaridades ou dist√¢ncias entre um objeto e cada um dos membros do grupo ou, no caso de um grupo previamente formado, entre todos os membros dos dois grupos. Todos os objetos recebem pesos iguais no c√°lculo.

O m√©todo de Ward √© baseado no crit√©rio de quadrados m√≠nimos (OLS), o mesmo utilizado para ajustar um modelo linear. O objetivo √© definir os grupos de maneira que a soma de quadrados (i.e. similar ao erro quadrado da ANOVA) dentro dos grupos seja minimizada [@borcard2018].

No entanto, para interpretar os resultados precisamos antes definir um n√≠vel de corte, que vai nos dizer quantos grupos existem. H√° v√°rios m√©todos para definir grupos, desde os heur√≠sticos aos que utilizam bootstrap. Se quisermos interpretar este dendrograma, podemos por exemplo estabelecer um n√≠vel de corte de 50% de dist√¢ncia (ou seja, grupos cujos objetos tenham ao menos 50% de similaridade entre si).

**Checklist**

-   Verifique se n√£o h√° espa√ßo nos nomes das colunas e linhas
-   Se os dados forem de abund√¢ncia, recomenda-se realizar a transforma√ß√£o de Hellinger [@legendre2001].
-   Se a matriz original contiver muitos valores discrepantes (e.g., uma esp√©cie muito mais ou muito menos abundante que outras) √© necess√°rio transformar os dados usando `log1p`.
-   Se as vari√°veis forem medidas tomadas em diferentes escalas (metros, graus celcius etc), √© necess√°rio padronizar cada vari√°vel para ter a m√©dia 0 e desvio padr√£o 1. Isso pode ser feito utulizando a fun√ß√£o `decostand` do pacote `vegan`.

## Exemplo 1:

Neste exemplo vamos utilizar um conjunto de dados que cont√©m larvas de esp√©cies de anf√≠bios anuros coletados em 14 po√ßas que diferiam em termos de cobertura de dossel.

**Pergunta:**

> Existem grupos de esp√©cies de anf√≠bios anuros com padr√µes de ocorr√™ncia similar ao longo de po√ßas?

**Predi√ß√µes**

> Iremos encontrar ao menos dois grupos de esp√©cies: aquelas que ocorrem em po√ßas dentro de floresta vs. aquelas que ocorrem em po√ßas de √°reas abertas.

**Vari√°veis**

-   Vari√°veis preditoras

    -   A nossa matriz de dados cont√©m a abund√¢ncia das esp√©cies nas linhas e locais (po√ßas) nas colunas.

### An√°lise

Para come√ßar, vamos primeiro importar os dados e depois calcular a matriz de dist√¢ncia que seja adequada para o tipo de dado que temos (abund√¢ncia de esp√©cies - dados de contagem)

```{r message=FALSE, warning=FALSE}
library(vegan) 

sp_compos <- ecodados::multivar_bocaina
head(sp_compos)
#produz uma matriz de similaridade com o coeficiente de Morisita-Horn
distBocaina <- vegdist(sp_compos, method="horn")
#produz um agrupamento com a fun√ß√£o hclust e o m√©todo UPGMA
dendro <- hclust(distBocaina, method="average")
```

Visualizar os resultados

```{r}
plot(dendro)
```

#### Assessando a qualidade do dendrograma

Precisamos verificar que o agrupamento reduziu a dimensionalidade da matiz de forma eficiente, de maneira a n√£o distorcer a informa√ß√£o. Fazemos isso calculando o **Coeficiente de correla√ß√£o cofen√©tica (CCC)**

```{r}
cofresult <- cophenetic(dendro)
cor(cofresult, distBocaina)
```

Um CCC \> .7 indica uma boa representa√ß√£o. Portanto, o nosso resultado de `r cor(cofresult, distBocaina)` √© bastante alto, garantindo que o dendrograma √© adequado.

```{r}
plot(dendro)
k = 4
n = ncol(sp_compos)
MidPoint = (dendro$height[n-k] + dendro$height[n-k+1]) / 2
abline(h = MidPoint, lty=2)
```

Nesse caso teremos a forma√ß√£o de cinco grupos, representados pelos n√≥s que est√£o abaixo da linha de corte. Portanto, o resultado n√£o suporta a nossa hip√≥tese *a priori* que predizia a forma√ß√£o de apenas dois grupos de esp√©cies.

## Exemplo 2:

No exemplo anterior vimos que √© dif√≠cil interpretar os grupos baseado num n√≠vel de corte. A seguir, vamos utilizar o pacote `pvclust` que calcula automaticamente o n√≠vel de corte de similaridade baseado no Bootstrap de cada n√≥. Uma desvantagem deste m√©todo √© que ele somente aceita √≠ndices de similaridade da fun√ß√£o `dist` que possui apenas a dist√¢ncia Euclidiana, Manhattan e Canberra. Uma maneira de contornarmos essa limita√ß√£o √© utilizar transforma√ß√µes dos dados dispon√≠veis na fun√ß√£o `disttransform` no pacote `BiodiversityR` ou o `decostand` do pacote `vegan`. Tamb√©m √© poss√≠vel utilizar a transforma√ß√£o de Box-Cox para dados multivariados, dispon√≠vel no material suplementar de [@legendre2018] [aqui](http://www.ecography.org/appendix/ecog-03498)

### An√°lise

Vamos utilizar o mesmo conjunto de dados acima pra responder √† mesma pergunta.

```{r message=FALSE, warning=FALSE}
library(pvclust)
library(BiodiversityR)
```

Aqui vamos utilizar a dist√¢ncia de Chord para calcular a matriz de dist√¢ncia. Se transformarmos uma matriz usando a transforma√ß√£o Chord e depois calcularmos a dist√¢ncia Euclidiana, isso equivale √† calcular diretamente a dist√¢ncia de Chord:

```{r}
bocaina_transf <- disttransform(bocaina, "chord")
analise <- pvclust(bocaina_transf, method.hclust="average", method.dist="euclidean") 
plot(analise, hang=-1)
pvrect(analise)
```

√â poss√≠vel notar que existe um √∫nico grupo com BS \> 95%. Agora vamos tentar usar a dist√¢ncia de Hellinger:

```{r}
bocaina_transf2 <- disttransform(bocaina, "hellinger")
analise2 <- pvclust(bocaina_transf2, method.hclust="average", method.dist="euclidean") 
plot(analise2, hang=-1)
pvrect(analise2)
```

### Interpreta√ß√£o dos resultados

Notem que se mudarmos o coeficiente de associa√ß√£o, o resultado tamb√©m muda. Agora temos 1 grupo a mais, composto por *Dendropsophus minutus* e *Scinax duartei* que n√£o apareciam antes. Isso se deve ao fato de que a dist√¢ncia de Hellinger d√° menos peso para esp√©cies raras do que a Chord.

Neste sentido, os dados n√£o suportam a nossa hip√≥tese inicial da forma√ß√£o de dois grupos, independentemente do coeficiente de associa√ß√£o utilizado.

# K-means e agrupamentos n√£o-hierarquicos

## Backgorund da an√°lise

K-means √© um tipo de agrupamento n√£o hierarquico porque n√£o busca obter grupos menores que por sua vez pertencem a grupos maiores. Resumidamente, podemos calcular o K-means apartir de uma matriz quadrada ou de dist√¢ncia. Essa t√©cnica procura particionar os objetos em *k* grupos de maneira a minimizar a soma de quadrados entre grupos e maximiz√°-la dentro dos grupos. Um crit√©rio similar ao de uma ANOVA.

## Exemplo 1

Para este exemplo iremos utilizar um conjunto de dados dispon√≠vel no pacote `ade4` que cont√©m dados de 27 esp√©cies de peixes coletados em 30 pontos ao longo do Rio Doubs, na fronteira entre a Fran√ßa e Sui√ßa.

**Pergunta:**

> Qual √© o n√∫mero de grupos que melhor sumariza o padr√£o de ocorr√™ncia de esp√©cies de peixes ao longo de um riacho?

**Predi√ß√µes**

> -   O agrupamento ideal para explicar a vari√¢ncia no padr√£o de ocorr√™ncia de esp√©cies √© 4.

**Vari√°veis**

-   Vari√°veis resposta

### Explica√ß√£o da an√°lise

Um diferencial do K-means em rela√ß√£o aos agrupamentos hierarquicos (=clusters) √© que o usu√°rio pode escolher antecipadamente o n√∫mero de grupos que quer formar.

**Checklist**

-   Vamos normalizar os dados de abund√¢ncia antes de entrar na an√°lise propriamente, j√° que existem muitos zeros na matriz.

### An√°lise

```{r message=FALSE, warning=FALSE}
library(ade4)
data(doubs)
head(doubs$fish)
spe <- doubs$fish[-8,]# retiro a linha 8, pois n√£o h√° dados
spe.norm <- decostand(spe, "normalize") # fun√ß√£o do pacote vegan, ela faz v√°rias padroniza√ß√µes, aqui ele normaliza  
```

O argumento `centers` na fun√ß√£o abaixo indica o n√∫mero de grupos que se quer formar. Neste exemplo estamos utilizando `centers=4`.

```{r}
spe.kmeans <- kmeans(spe.norm, centers=4, nstart=100)
spe.kmeans
```

O objeto que fornece o resultado cont√©m: 1) o tamanho (n√∫mero de objetos) em cada um dos 4 grupos; 2) o centroid de cada grupo e o pertencimento de cada esp√©cie a cada grupo; e 3) o quando da Soma de Quadrados dos dados √© explicada por esta conforma√ß√£o de grupos.

No entanto, n√£o √© poss√≠vel saber a priori qual o n√∫mero *ideal* de grupos. Para descobrir isso repetimos o k-means com uma s√©rie de valores de **K**. Isso pode ser feito na fun√ß√£o `cascadeKM`.

```{r}
spe.KM.cascade <- cascadeKM(spe.norm, inf.gr=2, sup.gr=10, iter=100, criterion="ssi") 
```

Tanto **calinski** quando **ssi** s√£o bons crit√©rios para encontrar o n√∫mero ideal de grupos. Quanto maior o valor de **ssi** melhor (veja `?cascadeKM` mais detalhes).

```{r}
# summary
spe.KM.cascade$results
```

SSE: crit√©rio utilizado pelo algor√≠timo para achar o agrupamento √≥timo dos objetos.

```{r}
plot(spe.KM.cascade, sortg=TRUE)
```

### Interpreta√ß√£o dos resultados

Diferentemente da nossa predi√ß√£o inicial, o resultado da an√°lise mostra que o n√∫mero ideal de grupos para explicar a vari√¢ncia no padr√£o de ocorr√™ncia de esp√©cies √© 3. Notem que o SSI m√°ximo √© alcan√ßado neste n√∫mero de grupos `r spe.KM.cascade$results[2,2]` (tamb√©m indicado pela bola vermelha no plot).

# Esp√©cies indicadoras

## Backgorund da an√°lise

Uma pergunta normalmente feita por ec√≥logos √©: qual esp√©cie pode ser indicadora de uma determinada condi√ß√£o ambiental?

O √≠ndice IndVal mede dois aspectos das esp√©cies: Especificidade e fidelidade. Uma alta fidelidade significa que esp√©cies ocorrem em todos os locais do grupo e uma alta especificidade significa que as esp√©cies ocorrem somente naquele grupo. Uma boa esp√©cie indicadora √© aquela na qual todos os indiv√≠duos ocorrem em todas a amostras referentes a um grupo espec√≠fico. A Especificidade √© dada pela divis√£o da abundancia m√©dia da esp√©cie no grupo pela somat√≥ria das abundancias m√©dias dos grupos. Fidelidade √© igual ao n√∫mero de lugares no grupo onde a esp√©cie est√° presente dividido pelo n√∫mero total de lugares do grupo (Dufr√™ne & Legendre, 1997).

Esp√©cies raras podem receber o mesmo valor de IndVal das esp√©cies indicadoras e s√£o chamadas de indicadoras assim√©tricas, i.e., contribuem com a especificidade do habitat mas n√£o servem para predizer grupos. Ao contr√°rio, as esp√©cies indicadoras s√£o verdadeiros indicadores sim√©tricos e podem ser usadas para predizer grupos.

## Exemplo 1:

**Pergunta:**

> Qual esp√©cie de anf√≠bio anuro na fase larval pode ser indicadora da fitofisionomia onde √© encontrada?

**Predi√ß√µes**

> -   1: Esp√©cies terrestres ser√£o indicadoras de √°rea aberta, enquanto esp√©cies arbor√≠colas ser√£o indicadoras de √°reas florestais.

**Vari√°veis**

-   Vari√°veis resposta

    -   Mesma matriz j√° utilizada contendo a abund√¢ncia de girinos ao longo de po√ßas na Serra da Bocaina.

### Explica√ß√£o da an√°lise

A an√°lise procede da seguinte forma:

-   Uma matriz de dist√¢ncia √© constru√≠da e as unidades amostrais s√£o classificadas com alguma an√°lise de agrupamento, hier√°rquico ou n√£o;

-   A vari√°vel ambiental para a qual se deseja classificar os grupos √© inserida;

-   As esp√©cies indicadoreas de cada grupo s√£o formadas atrav√©s do c√°lculo da especificidade e fidelidade, obtendo-se o valor de IndVal para cada esp√©cie;

-   Por fim, o conjunto de dados originais √© comparado para ver se an√°lise faz sentido.

O c√°lculo da signific√¢ncia do √≠ndice de IndVal √© feito por aleatoriza√ß√£o de Monte Carlo. Assim, o valor do √≠ndice √© aleatorizado 999 vezes (ou o n√∫mero de vezes que voc√™ optar) dentro dos tratamentos e o valor de *P* √© dado pelo n√∫mero de vezes em que o √≠ndice observado foi igual ou maior que os valores aleatorizados.

### An√°lise

Para este exemplo vamos utilizado o mesmo conjunto de dados utilizado acima com abund√¢ncia de 16 esp√©cies de girinos coletados em 14 po√ßas com diferentes graus de cobertura de dossel na Serra da Bocaina.

O IndVal est√° dispon√≠vel tanto no pacote `indicspecies` quando no `labdsv`. Para este exemplo iremos usar o labdsv.

```{r}
library(labdsv)
```

Primeiro vamos agrupar as unidades amostrais (po√ßas) que informa os grupos de fitofisionomias onde as po√ßas se localizam e para os quais deseja-se encontrar esp√©cies indicadoras:

```{r}
fitofis <- c(rep(1,4), rep(2,4), rep(3,4), rep(4,4), rep(5,4))
```

```{r}
resultado <- indval(bocaina, fitofis)
summary(resultado)#s√≥ exibe o resultado para as esp√©cies indicadoras
```

Para apresentar uma tabela dos resultados para todas as esp√©cies temos de processar os dados:

```{r}
resultado$maxcls
resultado$indcls
resultado$pval
tab.resultado=cbind(resultado$maxcls,resultado$indcls,resultado$pval)
colnames(tab.resultado)<-c("maxgrp", "ind. value","P")
tab.resultado
```

### Interpreta√ß√£o dos resultados

No resultado podemos ver que temos duas esp√©cies indicadoras da fitofisionimia 1: *Rhinella icterica* (Rict) e *Scinax duartei* (Sduar). Nenhuma esp√©cie foi indicadora dos outros grupos neste exemplo.

### Para se aprofundar

-   [Agrupamento de esp√©cies e locais baseado em modelos](https://www.sciencedirect.com/science/article/pii/S0304380010006393?casa_token=0YLFbVbGj1IAAAAA:RFcrLHBDdt-NY5gpxCEAqlc8LMG0ayzChpMvaOFQkE10ftg2Us6PafgMQCSmCZZ21eb430e_lWo)

-   [Numerical Ecology with R](http://adn.biol.umontreal.ca/~numericalecology/numecolR/)

-   [James & McCulloch (1990)](https://www.annualreviews.org/doi/pdf/10.1146/annurev.es.21.110190.001021)

-   [Legendre & Legendre (2012)](https://www.sciencedirect.com/bookseries/developments-in-environmental-modelling/vol/24)
